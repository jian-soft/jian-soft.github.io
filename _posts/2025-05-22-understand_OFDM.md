---
title: OFDM详解
---

## 引言

众所周知，OFDM(Orthogonal Frequency Division Mutiplexing, 正交频分多址)是现代无线通信(WiFi和4G)的底层关键技术。本文对其作下探究。它主要是将某一单独信道转化为若干正交子信道，从而实现将高速数据信号转换成并行的低速子数据流，然后把每个子数据流调制到子信道上进行传输。

在早期发展的无线通信系统中，采用了单载波调制（Single-carrier Modulation）技术。单载波调制是将要传送的信号调制在一个载波中，然后通过天线进行传输。根据信号隐藏在载波的不同方面，可分为振幅调制(AM, ASK)、频率调制(FM, FSK)和相位调制(PM, PSK)。使用单载波调制技术的通信系统，在增加传输速率时需要更大的载波带宽，即较短的符元时间长度。而短符元长度对信道的抗延迟能力大大减弱，一旦遇到干扰，误码率可能较高。为了解决前述问题，发展出了多载波调制技术。


## 无线通信系统模型

所谓通信就是信息的传递：
A地 --信息--> B地

无线通信的基本链路为：

发射：s(t) --调制--> s(t).cos(ωt) ----> 天线

接收：s(t) <--低通-- .cos(ωt) <--解调-- <---- 天线

s(t)为基带信号，cos(ωt)为载波信号。发射方向有两个核心部件，一个是调制器，一个是发射天线；接收方向有接收天线和解调器。

### 为什么需要调制

第一个原因：天线的尺寸和电磁波的波长差不多的时候，才能获得比较高的发射功率。

原始的电语音信号，其频率为声音的频率，为几KHz的量级。我们假设是10KHz，那么按照波长定义 λ = v*T = v/f = 光速/频率，10KHz电磁波对应的波长为：300000000m/s / 10000Hz = 30km。这么大的天线是制造不出来的，因此需要把信号调制到较高的频率，减小天线尺寸。

同时算一下2.4GHz和5GHz对应的波长：2.4GHz, 300000000/2400000000=12.5cm;
5GHz, 300000000/5000000000=6cm;
一般天线的最佳尺寸是波长的1/4或1/2.

第二个原因，频谱是受管理的，只能调制到特定的频率上去发送。同时调制到不同的频率范围内，实现多路复用。

在无线通信领域中，把低频信号s(t)称为基带信号，把调制后的射频信号称为已调信号。

### 双边带信号、单边带信号与IQ调制

我们讨论如下形式的已调信号：r(t)=s(t).cos(ωt)

基带信号s(t)是实数，由傅里叶变换的对称性可知，其频谱的幅度是偶函数，因此基带信号的频谱是关于零点对称的。这样就出现了负频率，负频率只有数学上的意义，并不实际占用带宽。但是基带信号调制到射频后，形成了关于ω的对称频谱，原来的负频率占用了实实在在的频率资源。我们把这种信号叫作双边带信号，ω左边的边带叫作下边带，右边的边带叫作上边带。

双边带信号占用了两倍的频率资源，造成了很大的浪费。

那怎么办呢？最简单的方法，就是把基带信号的频谱S(ω)砍掉一半，频谱函数为：S+(ω)=2S(ω).u(ω)。这里的u(ω)为阶跃函数，ω<0时u(ω)=0，ω>0时u(ω)=1。

然后对S+(ω)进行傅里叶逆变换，得到s+(t)。省去其中的数学过程，最终得出s+(t)=s(t)+js'(t)，s'(t)的定义这里略过。

于是发现，单边带信号是一个复数。进一步可以推理出，单边带信号同时利用了载波的幅度和相位，而双边带信号只利用了载波的幅度。或者等价地说，双边带信号只利用了余弦分量，而单边带信号同时利用了正弦和余弦两个正交分量。单边带信号利用了多一倍的信息，因此只需要一半的频谱资源。

如果我们独立地设置正弦和余弦分量，虽然带宽仍然是和双边带信号相同，但是传递的信息也增加了一倍，频谱效率和单边带信号是相同的。这个做法就是目前普遍使用的IQ调制技术，I指In-phase(同相), Q指Quadrature(正交)。

假设I路的信号为x(t), Q路的信号为y(t)，那么经过IQ调制后的信号为：
x(t).cos(ωt) - y(t).sin(ωt)。

接收端乘以cos(ωt)，滤掉倍频，解出x(t)；乘以-sin(ωt)，滤掉倍频，解出y(t)。

### 数字调制

我们前面讲的调制是指将基带信号的频谱搬移到射频载波的过程。模拟通信的目的是为了传送一个模拟信号，数字通信的目的是为了传送数字信号。对于数字通信，调制的内涵在扩大，将**数字信号映射成基带信号的过程**也称为调制，称之为数字调制。

数字基带信号可用如下公式来表达：
$$
s(t)=\sumI_n.g(t-nT_s)
$$
首先，时间被划分为长度为Ts的的片段，每个片段被称为1个符号，Ts叫作符号长度，1/Ts叫作符号速率。

In是第n个要发送的符号，我们使用复基带信号的表达方法，In一般为负数，可以取M个离散值，从而一个符号可以表达log2M个bit，比特速率为：
log2M/Ts。

g(t)是一个实函数，叫作脉冲成型函数，起到基带滤波和控制带外泄露的作用。每个符号通过g(t)产生一个波形，把所有的符号的波形按照时间顺序累加起来，就得到了复基带信号s(t)。后续把s(t)调制到载波上的过程，就是模拟调制。

数字基带信号所占用的带宽和符号率是有关系的。直接说结论：数字复基带信号所占用的最小带宽是1/Ts，即符号速率(这个结论来自于奈奎斯特第一准则？)。根据这个结论，假设带宽是20MHz，那么最大符号速率为20MSymbol/s，如果1个符号可以取1024个离散值，即1个符号可以携带10个bit，那么bit速率上限为200Mb/s。

#### 几种数字调制方式

在脉冲成形函数g(t)确定的情况下，数字调制的主要任务就是研究如何把比特b映射到符号I。

所有数字调制方法都是这3种方式的组合：调幅(ASK)，调相(PSK)，调频(FSK)。

2ASK符号有两种可能的取值，代表1bit；4ASK符号有4种可能取值，代表2bit。ASK信号为实数，其射频信号为双边带信号。

BPSK QPSK 8PSK，1个符号分别可以代表1bit 2bit 3bit，即将相位平均分成2份、4份、8份。16PSK则相位距离太近，基本不会考虑。

QAM(quadrature amplitude modulation, 正交幅度调制)，指的是在实部和虚部两个正交维度上采用幅度调制，这比ASK只在实部维度上采用幅度调制有优势。

4QAM相当于实部和虚部上各2ASK，2x2=4种组合，可以表示2bit。16QAM就相当于实部和虚部上各4ASK，4x4=16种组合，可以表示4bit。

另外，要想信号传的远，就需要功放。理想的功放应该是这个样子：y(t)=k.x(t)。但实际的功放是非线性的，只在一定范围内是线性区域。如果输入信号的功率有起伏，那么信号的平均功率会被进一步压低。因此，峰均比是信号的一个重要指标：PAPR=Ppeak/Pavg。

如果只调频或调相得话，基带信号可以是恒包络的，即幅度是固定值，具有最低的PAPR值，对功放的要求最低。后面出现了一种新的线性功放技术，DPD(digital pre-distortion, 数字预失真)，即在功放的非线性区域，提前给信号一个失真处理，经过功放非线性区域后，信号变成线性放大，这样就较大程度地扩大了功放的线性范围。这样对信号的PAPR就没那么苛刻了，从而使得QAM调制成为当前数字调制的最大赢家。

### 更完整的无线数字通信系统

本章开头描述的通信模型更偏向于基础的无线模拟通信系统，对于无线数字通信系统，更完整的模型如下：

信源->信源编码->信道编码->交织->数字调制->脉冲成形->模拟调制->发射天线

信宿<-信源译码<-信道译码<-去交织<-采样判决<-模拟解调<-接收天线

其中数字调制和脉冲成形前面已经讲过。
这里的信道编码和交织指的是：由于信道当中存在噪声，通信总会出现错误；如果在发射方通过编码的方法使得接收方能够正确解调，这种技术叫作前向纠错技术，也就是这里指的信道编码。信道编码的一般方法是：要传输k个bit，通过信道编码成n个bit，n>k；接收端收到n个bit后，解码出k个信息bit。

## OFDM

从字面上看，OFDM采用了FDM技术。一般的FDM，为了避免载波之间相互干扰，增加了保护带宽，造成了频谱浪费。OFDM为了提高频谱利用率，采用了相互正交的子载波，子载波间不需要增加保护带宽。

OFDM的本质就是发送端用待调制的数据对一系列复指数信号进行加权，合成一个复信号，利用IQ调制发送出去，接收端通过IQ解调恢复出复信号，求出加权系数，也就是傅里叶系数，就得到了调制数据。在实际的通信系统中，一般使用IDFT来实现基带OFDM调制，使用DFT来实现基带OFDM解调。

具体数学细节，待未来研究。

### OFDM如何克服多径效应

多径效应会引起符号间干扰，而消除符号间干扰的技术称作均衡。

在OFDM技术里面，采用了循环前缀的技术(CP, cyclic prefix)。最终的发射序列为：|CP|OFDM Symbol|CP|OFDM Symbol|




